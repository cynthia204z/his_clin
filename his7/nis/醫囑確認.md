# é†«å›‘ç¢ºèª

èˆŠ: Nis3020

æ–°: Nis3023

æ–¹æ³•æµç¨‹çœ‹Nis3023çš„æºç¢¼ï¼Œä¿ç•™çš„èˆŠæŒ‰éˆ•å†çœ‹Nis3020

> **â–² æ‡‰è©²å¯ä»¥åˆä½µçš„æŸ¥è©¢**
>
> oneTouchã€TcBILã€Residual urine
>
> ä¾†è‡ªåŒä¸€å¼µè¡¨ï¼Œé¡¯ç¤ºä¸åŒçš„æ¬„ä½

## è€—æé€£å¸¶é …-æ–°å¢è€—æ

<img src="image-20220607090834270.png" alt="image-20220607090834270" style="zoom: 67%;" />

```xml
<mx:Button id="addFeePkg" label="æ–°å¢è€—æ" paddingTop="0" paddingBottom="0" click="feePkgPopupHandle()" enabled="{this.nisExecuteOrderRecordTable.adg.selectedItem!=null}"/>
```

```typescript
/**
       * Descï¼šæ–°å¢è€—æPopUp Window.
       * Author Huang
       * Change Historyï¼š
       * Last Modify authorï¼šHuang Dateï¼š2009/07/03 Versionï¼š1.0
       * change Descriptionï¼š
 */       
public function feePkgPopupHandle():void {
   //var master: NisExecuteOrderRecordNewCustomForm= this["nisExecuteOrderRecordTable"] as  NisExecuteOrderRecordNewCustomForm;//é†«å›‘ç¢ºèªé …
   var master:Object        
   if(this["selectedView"]=="1"){       
      master= this["nisExecuteOrderRecordTable"] //as NisExecuteMedRecordNewCustomForm;//é†«å›‘ç¢ºèªé …            
   }else if(this["selectedView"]=="2"){
      master= this["nisExecuteOrderRecordTableQ"] //as NisExecuteMedRecordNewCustomForm;//é†«å›‘ç¢ºèªé …           
   }
   if(this["executeSelectedItem"]!=null && this["executeSelectedItem"].unsignReason!="A" &&  this["executeSelectedItem"].billingSys=="NIS"){
      var mtrlpopup:NisFeemstTabLov = new NisFeemstTabLov();
      mtrlpopup.page = this;
      
      var  lStockCode:String    =this["costNo"]    as String   //åŸ·è¡Œåœ°é»(åº«åˆ¥)       
      mtrlpopup.invsql = "nisComInvStaioViewDTO.stockCode = '" + lStockCode + "' and (nisComInvStaioViewDTO.currTypeo='1' or nisComInvStaioViewDTO.currTypee='1' or nisComInvStaioViewDTO.currTypei='1') ";
      mtrlpopup.showTab3Flag = true;
      mtrlpopup.invsql2 = "nisComInvStaioViewDTO.stockCode = '" + lStockCode + "' and (nisComInvStaioViewDTO.currTypeo='1' or nisComInvStaioViewDTO.currTypee='1' or nisComInvStaioViewDTO.currTypei='1') and nisComInvStaioViewDTO.feeCode in ('MHEMO19','MHEMO20','MHEMO21','MHEMO22','MHEMO34','MHEMO35','MHEMO08','MHEMO09 ','MHEMO13','MHEMO14','MHEMO18','MHEMO28','MHEMO37','MHEMO15','MBLOO20','MAVFI02','MAVFI03','MAVFI04','MSYRI12','MSYRI13','MSYRI14','MSYRI15','CGLUC06','CFRAG01','CRECO01','CRECO02','CHEPA04','CNS03','CNS07')";
      mtrlpopup.callFunction = true;
      mtrlpopup.openPopUp(this.parentApplication as DisplayObject,true);
   }else if(this["executeSelectedItem"]!=null && this["executeSelectedItem"].unsignReason=="A"){
      Alert.show("è£œç¢ºèªé†«å›‘,ç„¡æ³•æ–°å¢é …ç›®")
   }else if(this["executeSelectedItem"]!=null && this["executeSelectedItem"].billingSys!="NIS"){
      Alert.show("éè­·å›‘å…¥å¸³,ç„¡æ³•æ–°å¢é …ç›®")
   }
}
```

popupLovï¼šNisClient\src\com\hcsaastech\ehis\nis\orderconfirm\view\lov\NisFeemstTabLov.mxml

```typescript
nisCodedtlDTO.codeType='InvA02'
```

### Tabsé¡¯ç¤ºåˆ¤æ–·

prop: orderType

```typescript
if(orderType=="LAB" || orderType=="PAHO" || orderType=="BLD"){
   onlyShow3Flag=true
}
```

- ç‹€æ³1 <span style="color:orange">onlyShow3Flag is  false && showTab3Flag is false</span>
  - NisComInvStaioViewTable (å¸¸å‚™)
  - NisComFeemstLovTable (å…¨é™¢)
- ç‹€æ³2 <span style="color:orange">onlyShow3Flag is  false && showTab3Flag is true</span>
  - NisComInvStaioViewTable2 (å¸¸ç”¨)
  - NisComInvStaioViewTable (å¸¸å‚™)
  - NisComFeemstLovTable (å…¨é™¢)
- ç‹€æ³3 <span style="color:orange">onlyShow3Flag is true</span>
  - NisComFeemstLovTable (å…¨é™¢)





# é†«å›‘ç¢ºèª æŒ‰éˆ•Dialog

## æ–°å¢è‡ªè²»é …

åŠŸèƒ½: æ–°å¢åˆ°é†«å›‘è™•ç½®ä½œæ¥­

HIS7: NisSelfPayGmsDialog

UIä½ç½®: top toolbar>æ–°å¢è‡ªè²»é …

Table: comOrdermstExamView

HIS3 Front End Source: NisSlefPayGmsLov

GetQuery:

```xml
queryId="ComOrdermstExamView comOrdermstExamViewDTO"
```

```typescript
private function init():void{
 var query:NisComOrderMstExamViewQurty =new NisComOrderMstExamViewQurty()
 query.criteria=new Array();
 var c1:ZQueryCriterion=new ZQueryCriterion(null,"comOrdermstExamViewDTO.examType in ('GMS1101','GMS1102') and comOrdermstExamViewDTO.enabled='Y' ",null)
 query.criteria.push(c1)
 var op:YOperation=query.execute();
 op.onResult=function(event:YOperationEvent):void{
   if(event.result!=null && event.result.result!=null){
      dataAry= event.result.result as ArrayCollection
   }
 }
}
```

SearchQuery:

```xml
<columns>
  <ZDataGridColumn dataField="orderitemCode" fieldKey="comOrdermstExamViewDTO.orderitemCode" width="120" editable="false" />
  <ZDataGridColumn dataField="displayName" fieldKey="comOrdermstExamViewDTO.displayName" width="250" editable="false" />
  <ZDataGridColumn dataField="qty" fieldKey="comOrdermstExamViewDTO.qty" width="50" editable="true" />		
</columns>
```

<span style="color:orange;border:1px solid; padding: 2px 5px;">é€²åº¦</span>

- [x] UI
- [ ] DATA

## è¼¸é€ä½œæ¥­

> è·¨æ¨¡çµ„ï¼šBLOD è¡€åº«

HIS7: 

UIä½ç½®: top toolbar>è¼¸é€ä½œæ¥­

Table: 

HIS3 Front End Source: Blod1050MDtlEditPage

<span style="color:orange;border:1px solid; padding: 2px 5px;">é€²åº¦</span>

- [ ] UI
- [ ] DATA

## è€—ææ–°å¢

åŠŸèƒ½: æ–°å¢åˆ°é†«å›‘è™•ç½®ä½œæ¥­

HIS7: NisMtrlBasicDialog

UIä½ç½®: top toolbar>è€—ææ–°å¢

Table: nisMtrlBasic

HIS3 Front End Source: NisMtrlBasicLov

<span style="color:orange;border:1px solid; padding: 2px 5px;">é€²åº¦</span>

- [x] UI
- [ ] DATA

## è­·ç†æª¢é©—å€¼

> å…ˆä¸åšï¼Œåœ¨æ–°ç‰ˆé†«å›‘ç¢ºèªè£¡ä¹Ÿæ²’æœ‰

HIS7: 

UIä½ç½®: top toolbar>select>è­·ç†æª¢é©—å€¼

Table: 

HIS3 Front End Source: 

ğŸ”ºåŠŸèƒ½é‚„æ²’ææ‡‚

## oneTouch

HIS7: 

UIä½ç½®: top toolbar>select>oneTouch

Table: NIS_ONE_TOUCH_DATA

HIS3 Front End Source: Nis3021SgEditPage

<span style="color:orange;border:1px solid; padding: 2px 5px;">é€²åº¦</span>

- [ ] UI
- [ ] DATA

## TcBIL

HIS7: 

UIä½ç½®: top toolbar>select>TcBIL

Table: NIS_ONE_TOUCH_DATA

HIS3 Front End Source: Nis3024SgEditPage

GetQuery:

```
queryId="NisOneTouchData nisOneTouchDataDTO"
```

<span style="color:orange;border:1px solid; padding: 2px 5px;">é€²åº¦</span>

- [ ] UI
- [ ] DATA

## Residual urine

HIS7: 

UIä½ç½®: top toolbar>select>Residual urine

Table: NIS_ONE_TOUCH_DATA

HIS3 Front End Source: Nis3026SgEditPage

GetQuery:

```
queryId="NisOneTouchData nisOneTouchDataDTO"
```

<span style="color:orange;border:1px solid; padding: 2px 5px;">é€²åº¦</span>

- [ ] UI
- [ ] DATA

## æª¢é©—åˆ—å°

HIS7: NisLabPrintDialog

UIä½ç½®: top toolbar>æª¢é©—åˆ—å°

HIS3 Front End Source: NisLabPrintLov

<span style="color:orange;border:1px solid; padding: 2px 5px;">é€²åº¦</span>

- [x] UI
- [ ] Action

## æª¢é©—æ¢ç¢¼

HIS7: 

UIä½ç½®: é†«å›‘è™•ç½®ä½œæ¥­>search box>æª¢é©—æ¢ç¢¼

Table: 

HIS3 Front End Source: NisCheckBarcodeLov

<span style="color:orange;border:1px solid; padding: 2px 5px;">é€²åº¦</span>

- [ ] UI
- [ ] DATA

## æƒæè²¼ç´™

HIS7: BarcodeConfirmDialog

UIä½ç½®: é†«å›‘è™•ç½®ä½œæ¥­>search box>æƒæè²¼ç´™

Table: 

HIS3 Front End Source: BarcodeConfirmLov

<span style="color:orange;border:1px solid; padding: 2px 5px;">é€²åº¦</span>

- [x] UI
- [ ] DATA

## è£œå°è²¼ç´™

HIS7: 

UIä½ç½®: é†«å›‘è™•ç½®ä½œæ¥­>search box>è£œå°è²¼ç´™

Table: 

HIS3 Front End Source: NisCheckBarcodeLov

<span style="color:orange;border:1px solid; padding: 2px 5px;">é€²åº¦</span>

- [ ] UI
- [ ] DATA

